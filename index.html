<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ca√ßa ao Tesouro: O Mapa da Habilita√ß√£o</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Tamanho de fonte base, pode ser ajustado via JS */
            font-size: 100%; 
        }
        body {
            font-family: 'Merriweather', serif;
            background-image: url('https://i.pinimg.com/originals/c8/63/35/c863354728c342374d7336a2a4038a33.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            transition: background-color 0.3s;
        }
        .font-pirate {
            font-family: 'IM Fell English SC', serif;
        }
        .card-bg {
            background-color: rgba(253, 246, 221, 0.92);
            border: 2px solid #854d0e;
            transition: background-color 0.3s, border-color 0.3s;
        }
        .btn-start {
             transition: all 0.3s ease;
             box-shadow: 0 5px 15px rgba(133, 77, 14, 0.4);
        }
        .btn-start:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(133, 77, 14, 0.6);
        }
        .btn-option {
            transition: all 0.3s ease;
            border: 2px solid #c2a17d;
            background-color: #f5eadd;
        }
        .btn-option:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            border-color: #a17b54;
            background-color: #f8f1e9;
        }
        .btn-option:disabled {
            cursor: not-allowed;
        }
        .correct {
            background-color: #d1fae5 !important;
            border-color: #6ee7b7 !important;
            color: #065f46 !important;
        }
        .incorrect {
            background-color: #fee2e2 !important;
            border-color: #fca5a5 !important;
            color: #991b1b !important;
        }
        .explanation {
            border-left: 4px solid #854d0e;
            background-color: rgba(255, 251, 235, 0.95);
        }
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        .confetti {
            position: absolute;
            width: 10px;
            height: 15px;
            background-color: #f00;
            top: -20px;
            opacity: 0;
            animation: fall 4s linear infinite;
        }

        @keyframes fall {
            0% {
                transform: translateY(0vh) rotateZ(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotateZ(720deg);
                opacity: 0;
            }
        }

        /* Estilos de Alto Contraste */
        body.high-contrast {
            background-image: none;
            background-color: #fefce8; /* Fundo amarelo claro */
        }
        body.high-contrast .card-bg {
            background-color: #ffffff;
            border-color: #000000;
            color: #000000;
        }
        body.high-contrast .text-amber-900,
        body.high-contrast .text-amber-800,
        body.high-contrast .text-amber-700 {
            color: #000000;
        }
        body.high-contrast .btn-option {
            background-color: #ffffff;
            border-color: #000000;
            color: #000000;
        }
        body.high-contrast .btn-option:hover:not(:disabled) {
            background-color: #e2e8f0;
        }
        body.high-contrast .correct {
            background-color: #a7f3d0 !important;
            border: 3px solid #059669 !important;
            color: #000000 !important;
        }
        body.high-contrast .incorrect {
            background-color: #fecaca !important;
            border: 3px solid #dc2626 !important;
            color: #000000 !important;
        }
        body.high-contrast .bg-amber-800 {
            background-color: #000000;
            color: #ffffff;
        }
        body.high-contrast .hover\:bg-amber-900:hover {
            background-color: #333333;
        }
        body.high-contrast .explanation {
            background-color: #f1f5f9;
            border-left-color: #000000;
        }
        body.high-contrast #progress-bar {
            background-color: #000000;
        }
        body.high-contrast #progress-text {
            color: #000000;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4 bg-amber-50">

    <div id="accessibility-controls" class="fixed top-4 right-4 z-50">
        <div class="bg-white/80 backdrop-blur-sm rounded-lg shadow-lg p-2 flex flex-col items-center gap-2">
            <button id="contrast-toggle" title="Alternar Alto Contraste" class="p-2 rounded-full bg-gray-200 hover:bg-gray-300 transition">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M12 18a6 6 0 0 0 0-12v12z"></path></svg>
            </button>
            <button id="increase-font" title="Aumentar Fonte" class="p-2 w-10 h-10 flex items-center justify-center rounded-full bg-gray-200 hover:bg-gray-300 transition text-lg font-bold">A+</button>
            <button id="decrease-font" title="Diminuir Fonte" class="p-2 w-10 h-10 flex items-center justify-center rounded-full bg-gray-200 hover:bg-gray-300 transition text-sm font-bold">A-</button>
        </div>
    </div>

    <div id="sr-feedback" class="sr-only" aria-live="polite" aria-atomic="true"></div>
    
    <!-- TELA DE INTRODU√á√ÉO -->
    <div id="intro-container" class="w-full max-w-4xl mx-auto">
        <div class="card-bg rounded-xl shadow-2xl p-6 md:p-10 text-center text-amber-900">
            <h1 class="font-pirate text-5xl md:text-6xl mb-6">üéØ Ca√ßa ao Tesouro - Conhecendo as Regras</h1>
            <div class="max-w-2xl mx-auto text-lg md:text-xl text-amber-800 space-y-4 mb-8">
                 <p>Prepare-se, marujo! Sua miss√£o √© navegar pelos mares dos procedimentos administrativos.</p>
                 <p>Voc√™ aprender√° sobre as atribui√ß√µes do <strong>FNDE</strong>, das <strong>Entidades Executoras (EEx)</strong> e das <strong>Unidades Executoras (UEx)</strong> para encontrar o tesouro da habilita√ß√£o escolar.</p>
            </div>
            <button id="start-btn" class="font-pirate bg-amber-800 text-white py-4 px-10 rounded-lg shadow-lg hover:bg-amber-900 transition-all duration-300 text-3xl btn-start">Come√ßar o Desafio!</button>
        </div>
    </div>

    <!-- TELA DO QUIZ -->
    <main id="quiz-container" class="w-full max-w-4xl mx-auto hidden">
        <div class="card-bg rounded-xl shadow-2xl p-6 md:p-8 text-center text-amber-900">
            <h1 class="font-pirate text-5xl md:text-6xl mb-2">Ca√ßa ao Tesouro</h1>
            <h2 class="text-xl md:text-2xl mb-6">O Mapa da Habilita√ß√£o Escolar</h2>

            <div id="question-area">
                <p id="progress-text" class="text-lg mb-2 text-amber-800"></p>
                <div class="w-full bg-amber-200 rounded-full h-3.5 mb-4">
                    <div id="progress-bar" class="bg-amber-600 h-3.5 rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>

                <h3 id="question-text" class="text-2xl md:text-3xl font-bold mb-6 min-h-[150px] flex items-center justify-center">Carregando enigma...</h3>
                
                <div id="options-grid" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Op√ß√µes ser√£o inseridas aqui pelo JavaScript -->
                </div>
            </div>

            <div id="explanation-area" class="mt-8 text-left p-5 rounded-lg explanation hidden">
                <h4 class="font-bold text-xl mb-2 text-amber-900">O Segredo do Mapa:</h4>
                <p id="explanation-text" class="text-lg text-amber-800"></p>
            </div>
            
            <button id="next-btn" class="font-pirate bg-amber-800 text-white py-3 px-8 rounded-lg shadow-lg hover:bg-amber-900 transition-all duration-300 mt-8 text-2xl hidden">Pr√≥ximo Enigma &rarr;</button>

        </div>
    </main>

    <!-- TELA DE RESULTADOS -->
    <div id="results-container" class="w-full max-w-4xl mx-auto text-center hidden">
        <div class="card-bg rounded-xl shadow-2xl p-8 md:p-10 text-amber-900 relative overflow-hidden">
            <h1 id="results-title" class="font-pirate text-5xl md:text-6xl mb-4"></h1>
            <p id="results-subtitle" class="text-xl mb-4"></p>
            <p class="text-3xl font-bold mb-6">Sua pontua√ß√£o final: <span id="final-score" class="text-amber-800"></span></p>
            <div id="results-feedback-area" class="mx-auto mb-6 min-h-[128px] flex items-center justify-center">
                 <!-- Conte√∫do din√¢mico: Imagem, Parab√©ns ou Bot√£o de Tentar Novamente -->
            </div>
            <p id="results-final-message" class="text-lg"></p>
        </div>
    </div>


    <script>
        const quizData = [
            {
                question: "Sua escola √© representada por uma Associa√ß√£o de Pais e Mestres (APM) que gerencia diretamente os recursos recebidos. Essa APM √© classificada como uma:",
                options: ["EEx (Entidade Executora)", "UEx (Unidade Executora)", "EM (Entidade Mantenedora)", "Conselho Fiscal"],
                correctAnswer: 1,
                explanation: "A Unidade Executora (UEx) √© a entidade da comunidade escolar (como APM, C√≠rculo de Pais e Mestres, etc.) respons√°vel pela gest√£o dos recursos de programas espec√≠ficos em uma escola."
            },
            {
                question: "Uma prefeitura recebe verbas do governo para administrar e aplicar em 10 escolas que n√£o t√™m uma associa√ß√£o pr√≥pria. Neste cen√°rio, a prefeitura atua como uma:",
                options: ["UEx (Unidade Executora)", "UEx Consorciada", "EM (Entidade Mantenedora)", "EEx (Entidade Executora)"],
                correctAnswer: 3,
                explanation: "A Entidade Executora (EEx) √© uma entidade, como uma prefeitura ou secretaria de educa√ß√£o, que centraliza a gest√£o dos recursos para um conjunto de escolas que n√£o possuem UEx pr√≥pria."
            },
            {
                question: "Qual √© a principal diferen√ßa entre uma UEx (Unidade Executora) e uma EM (Entidade Mantenedora)?",
                options: [
                    "N√£o h√° diferen√ßa, s√£o a mesma coisa.",
                    "A UEx √© sempre p√∫blica e a EM √© sempre privada.",
                    "A EM √© respons√°vel pela manuten√ß√£o geral da escola, enquanto a UEx gerencia recursos de programas espec√≠ficos.",
                    "A UEx fiscaliza a EM."
                ],
                correctAnswer: 2,
                explanation: "A Entidade Mantenedora (EM) cuida da infraestrutura e funcionamento geral da escola. J√° a Unidade Executora (UEx) foca na administra√ß√£o de verbas de programas governamentais espec√≠ficos."
            }
        ];

        // Elementos do DOM
        const introContainer = document.getElementById('intro-container');
        const quizContainer = document.getElementById('quiz-container');
        const resultsContainer = document.getElementById('results-container');
        const startBtn = document.getElementById('start-btn');
        const questionText = document.getElementById('question-text');
        const optionsGrid = document.getElementById('options-grid');
        const explanationArea = document.getElementById('explanation-area');
        const explanationText = document.getElementById('explanation-text');
        const nextBtn = document.getElementById('next-btn');
        const finalScore = document.getElementById('final-score');
        const progressText = document.getElementById('progress-text');
        const progressBar = document.getElementById('progress-bar');
        const srFeedback = document.getElementById('sr-feedback'); 

        let currentQuestionIndex = 0;
        let score = 0;
        
        function startGame() {
            introContainer.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            explanationArea.classList.add('hidden');
            nextBtn.classList.add('hidden');
            optionsGrid.innerHTML = '';

            if (currentQuestionIndex >= quizData.length) {
                showResults();
                return;
            }

            const currentQuestion = quizData[currentQuestionIndex];
            progressText.textContent = `Enigma ${currentQuestionIndex + 1} de ${quizData.length}`;
            const progressPercentage = (currentQuestionIndex / quizData.length) * 100;
            progressBar.style.width = `${progressPercentage}%`;
            
            questionText.textContent = currentQuestion.question;
            srFeedback.textContent = `Enigma ${currentQuestionIndex + 1}: ${currentQuestion.question}`;

            currentQuestion.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.innerHTML = `<span class="font-bold mr-2">${String.fromCharCode(65 + index)}:</span> ${option}`;
                button.className = 'btn-option w-full text-left p-5 rounded-lg shadow-md text-amber-800 text-lg';
                button.dataset.index = index;
                button.addEventListener('click', selectAnswer);
                optionsGrid.appendChild(button);
            });
        }

        function selectAnswer(e) {
            const selectedButton = e.currentTarget;
            const selectedAnswerIndex = parseInt(selectedButton.dataset.index);
            const currentQuestion = quizData[currentQuestionIndex];
            const correctAnswerIndex = currentQuestion.correctAnswer;

            Array.from(optionsGrid.children).forEach(btn => {
                btn.disabled = true;
            });

            if (selectedAnswerIndex === correctAnswerIndex) {
                score++;
                selectedButton.classList.add('correct');
                srFeedback.textContent = `Resposta correta. ${currentQuestion.explanation}`;
            } else {
                selectedButton.classList.add('incorrect');
                optionsGrid.children[correctAnswerIndex].classList.add('correct');
                srFeedback.textContent = `Resposta incorreta. A resposta certa √©: ${currentQuestion.options[correctAnswerIndex]}. ${currentQuestion.explanation}`;
            }

            explanationText.textContent = currentQuestion.explanation;
            explanationArea.classList.remove('hidden');

            const progressPercentage = ((currentQuestionIndex + 1) / quizData.length) * 100;
            progressBar.style.width = `${progressPercentage}%`;

            if (currentQuestionIndex < quizData.length - 1) {
                nextBtn.textContent = 'Pr√≥ximo Enigma ‚Üí';
                nextBtn.classList.remove('hidden');
            } else {
                progressText.textContent = 'Mapa completo!';
                nextBtn.textContent = 'Ver o Tesouro!';
                nextBtn.classList.remove('hidden');
            }
        }

        function showResults() {
            quizContainer.classList.add('hidden');
            resultsContainer.classList.remove('hidden');
            finalScore.textContent = `${score} de ${quizData.length}`;
            srFeedback.textContent = `Quiz finalizado. Sua pontua√ß√£o final: ${score} de ${quizData.length}.`;

            const resultsTitle = document.getElementById('results-title');
            const resultsSubtitle = document.getElementById('results-subtitle');
            const feedbackArea = document.getElementById('results-feedback-area');
            const finalMessage = document.getElementById('results-final-message');
            
            feedbackArea.innerHTML = ''; // Limpa a √°rea de feedback

            if (score === 2) {
                resultsTitle.textContent = 'Parab√©ns!';
                resultsSubtitle.textContent = 'Voc√™ desvendou os enigmas da habilita√ß√£o escolar!';
                // N√£o exibe imagem, apenas o texto de parab√©ns abaixo da pontua√ß√£o.
                finalMessage.textContent = 'Agora voc√™ est√° mais perto de garantir os recursos para sua escola. Continue navegando pelos mares do conhecimento!';
                triggerConfetti();
            } else if (score < 2) { // Pontua√ß√£o 1 ou 0
                resultsTitle.textContent = 'Quase l√°!';
                resultsSubtitle.textContent = 'Parece que um tesouro ainda est√° escondido.';
                feedbackArea.innerHTML = `<button id="restart-btn" class="font-pirate bg-amber-800 text-white py-3 px-8 rounded-lg shadow-lg hover:bg-amber-900 transition-all duration-300 mt-4 text-2xl">Volte e reveja todas as quest√µes</button>`;
                finalMessage.textContent = 'Estude o mapa novamente para se tornar um capit√£o do conhecimento!';
                document.getElementById('restart-btn').addEventListener('click', () => window.location.reload());
            } else { // Pontua√ß√£o m√°xima
                resultsTitle.textContent = 'Tesouro Encontrado!';
                resultsSubtitle.textContent = 'Voc√™ desvendou todos os enigmas da habilita√ß√£o escolar!';
                feedbackArea.innerHTML = `<img src="https://img.icons8.com/external-flaticons-flat-flat-icons/128/external-treasure-pirates-flaticons-flat-flat-icons.png" 
                 alt="√çcone de ba√∫ do tesouro" 
                 class="mx-auto"
                 onerror="this.onerror=null; this.src='https://placehold.co/128x128/fdf6dd/854d0e?text=Tesouro!';">`;
                finalMessage.textContent = 'Voc√™ √© um mestre dos mares do conhecimento!';
                triggerConfetti();
            }
        }

        function triggerConfetti() {
            const container = document.querySelector('#results-container .card-bg');
            const colors = ['#f44336', '#e91e63', '#9c27b0', '#673ab7', '#3f51b5', '#2196f3', '#03a9f4', '#00bcd4', '#009688', '#4caf50', '#8bc34a', '#cddc39', '#ffeb3b', '#ffc107', '#ff9800'];
            for (let i = 0; i < 150; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = `${Math.random() * 4}s`;
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                container.appendChild(confetti);
            }
        }
        
        startBtn.addEventListener('click', startGame);

        nextBtn.addEventListener('click', () => {
            currentQuestionIndex++;
            loadQuestion();
        });

        // --- Controles de Acessibilidade ---
        const body = document.body;
        const contrastToggle = document.getElementById('contrast-toggle');
        const increaseFontBtn = document.getElementById('increase-font');
        const decreaseFontBtn = document.getElementById('decrease-font');

        const FONT_STEPS = [0.9, 1, 1.15, 1.3, 1.5]; 
        let currentFontStep = 1; // Come√ßa no tamanho padr√£o (100%)

        function updateFontSize() {
            document.documentElement.style.fontSize = `${FONT_STEPS[currentFontStep] * 100}%`;
        }

        contrastToggle.addEventListener('click', () => {
            body.classList.toggle('high-contrast');
        });

        increaseFontBtn.addEventListener('click', () => {
            if (currentFontStep < FONT_STEPS.length - 1) {
                currentFontStep++;
                updateFontSize();
            }
        });

        decreaseFontBtn.addEventListener('click', () => {
            if (currentFontStep > 0) {
                currentFontStep--;
                updateFontSize();
            }
        });

    </script>

</body>
</html>




